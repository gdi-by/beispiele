<!DOCTYPE html>
<html>
    <head>
        <title>BVV WMTS - Beispiel: OL3 EPSG:31468</title>
        <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
        <link rel="stylesheet" href="http://openlayers.org/en/latest/css/ol.css" type="text/css">
        <script src="https://openlayers.org/en/latest/build/ol.js"></script>

    </head>
    <body>

        <div id="map"></div>

        <script>

            var serviceKey = '{SERVICEKEY}';
            var url = [];
            url.push(
                    'http://www.geodaten.bayern.de/wmts/',
                    serviceKey,
                    '/1.0.0/WMTSCapabilities.xml'
                    );

            var parser = new ol.format.WMTSCapabilities();
            var map;

            $.get(url.join('')).then(function (response) {
                var result = parser.read(response);

                var projection = new ol.proj.Projection({
                    code: 'EPSG:31468',
                    extent: [3925712, 4974288, 4875712, 5924288],
                    units: 'm',
                    axisOrientation: 'neu'
                });
                ol.proj.addProjection(projection);

                // Layer-Identifier: z. B. 'by_webkarte'
                var options = ol.source.WMTS.optionsFromCapabilities(result,
                        {layer: 'by_webkarte', projection: projection.getCode()});

                map = new ol.Map({
                    layers: [
                        new ol.layer.Tile({
                            opacity: 1,
                            source: new ol.source.WMTS(options)
                        })
                    ],
                    target: 'map',
                    view: new ol.View({
                        projection: projection,
                        center: [4468499, 5333554],
                        zoom: 8
                    })
                });
            });

        </script>
    </body>
</html>
